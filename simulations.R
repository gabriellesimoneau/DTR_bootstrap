###################################################################################
expit <- function(x) exp(x)/(1+exp(x))
# m-out-of-n bootstrap

g <- matrix(NA, nrow = 9, ncol = 7)
g[1,] <- c(0,0,0,0,0,0,0)
g[2,] <- c(0,0,0,0,0.01,0,0)
g[3,] <- c(0,0,-0.5,0,0.5,0,-0.5)
g[4,] <- c(0,0,-0.5,0,0.99,0,-0.98)
g[5,] <- c(0,0,-0.5,0,1,0.5,-0.5)
g[6,] <- c(0,0,-0.5,0,0.25,0.5,0.5)
g[7,] <- c(0,0,-0.25,0,0.75,0.5,0.5)
g[8,] <- c(0,0,0,0,0.25,0,0.25)
g[9,] <- c(0,0,0,0,0.25,0,-0.24)

d <- matrix(NA, nrow = 9, ncol = 2)
d[1,] <- c(1,-1)
d[2,] <- c(1,-1)
d[3,] <- c(1,-1)
d[4,] <- c(1,-1)
d[5,] <- c(1,0)
d[6,] <- c(0.2,-0.2)
d[7,] <- c(0.2,-0.2)
d[8,] <- c(0,0)
d[9,] <- c(0,0)

n <- 300
A1 <- rbinom(n, size = 1, prob = 0.5)
A2 <- rbinom(n, size = 1, prob = 0.5)

O1 <- rbinom(n, size = 1, prob = 0.5)
O2 <- rbinom(n, size = 1, prob = expit(d[1,1]*O1 + d[1,2]*A1))

Y1 <- rep(0, n)
Y2 <- g[1,1] + g[1,2]*O1 + g[1,3]*A1 + g[1,4]*O1*A1 + g[1,5]*A2 + g[1,6]*O2*A2 + g[1,7]*A1*A2 + rnorm(n)


